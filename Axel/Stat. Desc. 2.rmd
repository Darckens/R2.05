---
title: "Statistiques Descriptives 2"
author: "Ibrahim BENKHERFELLAH & Axel COULET"
date: "2025-02-21"
output:
  html_document:
    df_print: paged
lang: fr
---

```{r eval=FALSE, include=FALSE}
# Run this the first time you open the document to install all the required packages

list.of.packages <- c("ggplot2", "ggthemes", "extrafont", "gridExtra", "lmtest")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[, "Package"])]
if (length(new.packages)) install.packages(new.packages)
```

```{r echo=FALSE, message=FALSE}
# Run these at the start

library(ggplot2)
library(ggthemes)
library(extrafont)
library(gridExtra)
library(lmtest)
```

```{r eval=FALSE, include=FALSE}
# Run these only one time
font_import()
loadfonts()
```


# __Exercice n°1__

## __1.__\

Tout d'abord, qu'est-ce qu'une variable explicative et une variable expliquée ?

-   Une variable explicative est la variable qui permet d'expliquer une autre variable. Elle est souvent notée $X$. Sur une représentation graphique, la variable explicative est représentée en abscisse.

-   Une variable expliquée est la variable pour laquelle on cherche un modèle de prévision. Son évolution dépend d'une ou de plusieurs autres variables. Elle est souvent notée $Y$. Sur une représentation graphique, la variable expliquée est représentée en ordonnée.\

Ainsi, dans le cadre de notre exercice, la variable explicative est le **dosage de sérum X (en mL)**. Et la variable expliquée est la **quantité de bactéries Y (en UFC/mL)**, car c'est celle qui est mesurée en fonction du dosage de sérum et qui dépend potentiellement de $X$.\

## __2.__\

Représentation du nuage de points de la statistique bi-variée ($x_{i};y_{i}$)\

```{r echo=FALSE, fig.align='center'}

data <- read.csv("../donnees_r.csv", header = TRUE, colClasses = c("numeric", "numeric"))

ggplot(data, aes(x = X, y = Y)) +
  geom_point(color = "red", size = 2) +
  labs(
    title = "Nuage de points : Dosage vs Bactéries",
    x = "Dosage de sérum (mL)",
    y = "Quantité de bactéries (UFC/mL)"
  ) +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(), text = element_text(family = "Segoe UI", size = 14))

```



## __3.__\

a\) Calcul de la moyenne et de la variance de la quantité de bactéries

- Moyenne : __$\overline{y} = 0,4389205$__  

- Variance : __$Var(y) = 0,0684857$__

<br>   

b\) Box-plot de la dsitribution de la variable : __Quantité de bactéries__

```{r echo=FALSE, fig.align='center'}
ggplot(data, aes(y = Y)) +
  geom_boxplot() +
  labs(title = "Boîte à moustache de la distribution\nde la quantité de bactéries") +
  theme_fivethirtyeight() +
  theme(text = element_text(family = "Segoe UI", size = 14))
```

<br>

c\) Analyse des résultats obtenus

L'analyse de la quantité de bactéries montre une moyenne de __$0,4389205$__ et une variance de __$0,0684857$__, indiquant une dispersion modérée. Le diagramme en boîte révèle une distribution symétrique avec une médiane autour de __$0,4$__ et un intervalle interquartile de __$0,23$__ à __$0,60$__, suggérant une répartition homogène des données.

## __4.__

Nous savons que la Covariance de $X$ et $Y$ est : $$Cov(X,Y) = \frac{1}{N}\sum_{i=1}^{i=N}(X_i - \overline{X})(Y_i - \overline{Y}) = (\frac{1}{N}\sum_{i=1}^{i=N}(X_iY_i)) - \overline{X}\overline{Y}$$\

On trouve donc : __$Cov(X, Y) = −0,7391376$__\

La covariance entre les deux variables étant de __$−0,7391376$__, cela indique une assez forte relation. Le signe étant négative, cela  indique que $X$ et $Y$ évoluent de manière opposé. Autrement dit, lorsque $X$ augmente, $Y$ quant à lui à diminuer, et inversement. Ce qui coincide avec l'observation faite ci-dessus, dans le nuage de point.

## __5.__

Parler des deux etapes

a\) Etude graphique Quantile-Quantile (jsp si faut en faire 2 ou un, je trouve que en 2 en 1 la variable Y on voit pas de fou)

Version avec les deux sur le meme graph

```{r echo=FALSE, fig.align='center'}
# Les deux graphiques combiné

ggplot(data) +
  geom_qq(aes(sample = X, color = "X"), geom = "point", position = "identity") +
  geom_qq(aes(sample = Y, color = "Y"), geom = "point", position = "identity") +
  labs(title = "Q-Q Plot de X et Y", color = "Variable :") +
  scale_color_manual(values = c("X" = "red", "Y" = "blue")) +
  theme_fivethirtyeight() +
  theme(text = element_text(family = "Segoe UI", size = 14))
```

Nous pouvons observer que la variable $Y$ a l'air de suivre une distribution normale. En effet, les points sont gloabelement alignés.\

Cependant, pour $X$, c'est tout l'inverse ! Pour une distribution normale, de manière graphique (avec Q-Q Plot), nous nous attendons à voir une droite se déssiner. Or, ici, on observe une courbure marquée, montrant ainsi que $X$ ne suit pas une distribution normale.

<br>

Version avec les deux graph séparé

```{r echo=FALSE, fig.align='center'}
qqX <- ggplot(data) +
  geom_qq(aes(sample = X), geom = "point", position = "identity") +
  ggtitle("Q-Q Plot de X") +
  theme_fivethirtyeight() +
  theme(text = element_text(family = "Segoe UI", size = 14))

qqY <- ggplot(data) +
  geom_qq(aes(sample = Y), geom = "point", position = "identity") +
  ggtitle("Q-Q Plot de Y") +
  theme_fivethirtyeight() +
  theme(text = element_text(family = "Segoe UI", size = 14))

grid.arrange(qqX, qqY, ncol = 2)
```

<br>

b\) Etude numérique Shapiro-Wilk

en parler

```{r echo=FALSE}
shapiro.test(data$X)
shapiro.test(data$Y)
```
## __6.__

analyser le coeff de corr

```{r echo=FALSE}
cor.test(data$X, data$Y, method = "pearson")
```

## __7.__

Calcul des Moindres Carrés Ordinaires : 

-  Forme de la droite affine : $\hat{y}=\hat{a}x+\hat{b} = -0,0835x+0,8565$

-  $\hat{a} = \frac{cov(X, Y)}{Var(X)}$

-  $\hat{a} = -0,0835 = \frac{−0,7391376}{8,850479}$ avec $Var(x) = 8,850479$ et $cov(X, Y) = −0,7391376$

-  $\hat{b} = \overline{y}-\hat{a}\overline{x}$

-  $\hat{b} = 0,8565 = \overline{y}-\hat{a}\overline{x}$ avec $\overline{y}= 0,4389205$, $\hat{a} = -0,0835$ et $\overline{x}= 5$

```{r echo=FALSE, fig.align='center'}
ggplot(data, aes(x = X, y = Y)) +
  geom_point(color = "red", size = 2) +
  geom_abline(slope = -0.0835, intercept = 0.8565, color = "blue", linewidth = 1) +
  labs(
    title = "Nuage de points : Dosage vs Bactéries",
    x = "Dosage de sérum (mL)",
    y = "Quantité de bactéries (UFC/mL)"
  ) +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(), text = element_text(family = "Segoe UI", size = 14))
```

## __8.__

a faire

## __9.__

```{r echo=FALSE}
LMS <- lm(data$Y ~ data$X)
summary(LMS)
```

expliquer et analyser resultat obtenu avec summary

## __10.__

```{r echo=FALSE}
deviance(LMS)
sum(residuals(LMS)^2)
```

## __11.__

a\) Évaluer l’indépendance des résidus

i) 

```{r echo=FALSE}
residuals <- residuals(LMS)
acf(residuals, main = "Autocorrélation des résidus")
```

i)

```{r echo=FALSE}
dw_test <- dwtest(LMS)
print(dw_test)
```

b\) Tester la normalité des résidus

i) 

Shapiro-Wilk

i)

Quantile-Quantile (Q-Q plot)

## __12.__

$\log{y} = \log{(b.ax)} = \log{b} + x.\log{a}$  
$\log{y} = \log{(b.ax)} = -0,067277834 + x.-1,078241507$


```{r echo=FALSE, fig.align='center'}
exponential_function <- function(x) {
  1.0343 * exp(-0.209 * x)
}

ggplot(data, aes(x = X, y = Y)) +
  geom_point(color = "red", size = 2) +
  geom_abline(slope = -0.0835, intercept = 0.8565, color = "blue", linewidth = 1) +
  stat_function(fun = exponential_function, color = "green", linewidth = 1) +
  labs(
    title = "Nuage de points : Dosage vs Bactéries",
    x = "Dosage de sérum (mL)",
    y = "Quantité de bactéries (UFC/mL)"
  ) +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(), text = element_text(family = "Segoe UI", size = 14))
```

## __13.__

1. 

????

1.

????

## __14.__

$0,1885 = -0,0835\times8+0,8565$
$0,1943 = 1,0343e^{-0,209\times8}$

## __Bonus__

?????

## Valeur peut être utile

```{r echo=FALSE}
var(data$Y)
var(data$X)
mean(data$Y)
mean(data$X)
cov(data$X, data$Y, method = "pearson")
median(data$Y)
quantile(data$Y)
```
